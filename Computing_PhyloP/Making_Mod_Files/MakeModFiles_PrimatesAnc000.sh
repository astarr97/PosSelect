#!/bin/bash
#SBATCH --time=168:00:00
#SBATCH -p hbfraser
#SBATCH --mem=64GB
#SBATCH -c 1

cat *fasta.out > PrimatesAnc000_Merged_rmsk.fasta.out

#Need to remove repeat sequences annotated as structural RNA copies, satellites, tandem repeats, and low complexity annotations
python ../filter_repeats.py PrimatesAnc000_Merged_rmsk.fasta.out
awk -v OFS='\t' '{print $5,$6,$7}' PrimatesAnc000_Merged_rmsk.fasta.filt.out | sort -k1,1 -k2,2n | bedtools merge -i - > PrimatesAnc000_Merged_rmsk.fasta.filt.bed

../cactus-bin-v2.6.13/bin/halLiftover ../hg38.447way.hal PrimatesAnc000 PrimatesAnc000_Merged_rmsk.fasta.filt.bed PrimatesAnc015 PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc015.bed --noDupes --outPSL
../cactus-bin-v2.6.13/bin/halLiftover ../hg38.447way.hal PrimatesAnc000 PrimatesAnc000_Merged_rmsk.fasta.filt.bed PrimatesAnc014 PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc014.bed --noDupes --outPSL
../cactus-bin-v2.6.13/bin/halLiftover ../hg38.447way.hal PrimatesAnc000 PrimatesAnc000_Merged_rmsk.fasta.filt.bed PrimatesAnc008 PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc008.bed --noDupes --outPSL
../cactus-bin-v2.6.13/bin/halLiftover ../hg38.447way.hal PrimatesAnc000 PrimatesAnc000_Merged_rmsk.fasta.filt.bed PrimatesAnc004 PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc004.bed --noDupes --outPSL
../cactus-bin-v2.6.13/bin/halLiftover ../hg38.447way.hal PrimatesAnc000 PrimatesAnc000_Merged_rmsk.fasta.filt.bed PrimatesAnc002 PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc002.bed --noDupes --outPSL

awk -v OFS='\t' '{print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc015.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc015.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc015.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc015.bed
bedtools intersect -a PrimatesAnc000_Merged_rmsk.fasta.filt.bed -b PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc015.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.bed

awk -v OFS='\t' '{print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc014.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc014.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc014.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc014.bed
bedtools intersect -a PrimatesAnc000_Merged_rmsk.fasta.filt.bed -b PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc014.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.bed

awk -v OFS='\t' '{print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc008.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc008.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc008.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc008.bed
bedtools intersect -a PrimatesAnc000_Merged_rmsk.fasta.filt.bed -b PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc008.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.bed

awk -v OFS='\t' '{print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc004.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc004.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc004.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc004.bed
bedtools intersect -a PrimatesAnc000_Merged_rmsk.fasta.filt.bed -b PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc004.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.bed

awk -v OFS='\t' '{print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc002.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc002.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc002.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc002.bed
bedtools intersect -a PrimatesAnc000_Merged_rmsk.fasta.filt.bed -b PrimatesAnc000_Merged_rmsk.fasta.filt.PrimatesAnc002.bed > PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" && mv PrimatesAnc000_Merged_rmsk.fasta.filt.bed"_temp" PrimatesAnc000_Merged_rmsk.fasta.filt.bed

bedops --chop 1 PrimatesAnc000_Merged_rmsk.fasta.filt.bed | shuf -n 100000 | sort -k1,1 -k2,2n | bedtools merge -i - > PrimatesAnc000_Merged_rmsk.fasta.filt.100kb.bed
#For the next step, we print out which species we need using a short python script
#python ../get_subtree_species.py ../hg38.447way.tree.nh PrimatesAnc000

../cactus-bin-v2.6.13/bin/hal2maf --refTargets PrimatesAnc000_Merged_rmsk.fasta.filt.100kb.bed --refGenome PrimatesAnc000 --onlyOrthologs --targetGenomes "Papio_anubis,Papio_papio,Papio_hamadryas,Papio_ursinus,Papio_kindae,Papio_cynocephalus,Lophocebus_aterrimus,Theropithecus_gelada,Cercocebus_atys,Cercocebus_lunulatus,Cercocebus_torquatus,Cercocebus_chrysogaster,Mandrillus_leucophaeus,Mandrillus_sphinx,Macaca_leonina,Macaca_silenus,Macaca_siberu,Macaca_nemestrina,Macaca_nigra,Macaca_maura,Macaca_tonkeana,Macaca_fuscata,Macaca_cyclopis,Macaca_mulatta,Macaca_fascicularis,Macaca_assamensis,Macaca_thibetana,Macaca_radiata,Macaca_arctoides,Cercopithecus_albogularis,Cercopithecus_nictitans,Cercopithecus_ascanius,Cercopithecus_cephus,Cercopithecus_petaurista,Cercopithecus_lowei,Cercopithecus_mona,Cercopithecus_pogonias,Cercopithecus_neglectus,Cercopithecus_diana,Cercopithecus_roloway,Cercopithecus_hamlyni,Miopithecus_ogouensis,Allochrocebus_preussi,Allochrocebus_lhoesti,Allochrocebus_solatus,Chlorocebus_aethiops,Chlorocebus_pygerythrus,Chlorocebus_sabaeus,Erythrocebus_patas,Allenopithecus_nigroviridis,Trachypithecus_phayrei,Trachypithecus_crepusculus,Trachypithecus_obscurus,Trachypithecus_melamera,Trachypithecus_auratus,Trachypithecus_cristatus,Trachypithecus_germaini,Trachypithecus_francoisi,Trachypithecus_leucocephalus,Trachypithecus_laotum,Trachypithecus_hatinhensis,Trachypithecus_geei,Trachypithecus_pileatus,Semnopithecus_entellus,Semnopithecus_hypoleucos,Semnopithecus_priam,Semnopithecus_schistaceus,Semnopithecus_johnii,Semnopithecus_vetulus,Pygathrix_cinerea,Pygathrix_nigripes_b,Pygathrix_nigripes_a,Rhinopithecus_strykeri,Rhinopithecus_bieti,Rhinopithecus_roxellana,Nasalis_larvatus,Presbytis_mitrata,Presbytis_comata,Colobus_polykomos,Colobus_guereza,Colobus_angolensis,Piliocolobus_tephrosceles,Piliocolobus_gordonorum,Piliocolobus_kirkii,Piliocolobus_badius,Pan_paniscus,Pan_troglodytes,Homo_sapiens,Gorilla_gorilla,Gorilla_beringei,Pongo_abelii,Pongo_pygmaeus,Hylobates_pileatus_b,Hylobates_pileatus_a,Hylobates_abbotti,Hylobates_muelleri,Hylobates_agilis,Hylobates_klossii,Hoolock_leuconedys,Nomascus_siki_b,Nomascus_siki_a,Nomascus_gabriellae,Nomascus_annamensis,Nomascus_concolor,Symphalangus_syndactylus,Mico_schneideri,Mico_argentatus,Mico_humeralifer,Callibella_humilis,Cebuella_pygmaea,Cebuella_niveiventris,Callithrix_kuhlii,Callithrix_jacchus,Callithrix_geoffroyi,Callimico_goeldii,Leontopithecus_rosalia,Leontopithecus_chrysomelas,Saguinus_bicolor,Saguinus_midas,Saguinus_oedipus,Saguinus_geoffroyi,Saguinus_mystax,Saguinus_labiatus,Saguinus_inustus,Saguinus_imperator,Leontocebus_illigeri,Leontocebus_fuscicollis,Leontocebus_nigricollis,Aotus_vociferans,Aotus_griseimembra,Aotus_nancymaae,Aotus_azarae,Aotus_trivirgatus,Cebus_olivaceus,Cebus_albifrons,Cebus_unicolor,Sapajus_macrocephalus,Sapajus_apella,Saimiri_oerstedii,Saimiri_ustus,Saimiri_cassiquiarensis,Saimiri_macrodon,Saimiri_sciureus,Saimiri_boliviensis,Alouatta_seniculus,Alouatta_juara,Alouatta_puruensis,Alouatta_macconnelli,Alouatta_nigerrima,Alouatta_caraya,Alouatta_belzebul,Alouatta_discolor,Alouatta_palliata,Ateles_marginatus,Ateles_chamek,Ateles_belzebuth,Ateles_paniscus,Ateles_geoffroyi_b,Ateles_geoffroyi_a,Lagothrix_lagothricha,Cacajao_hosomi,Cacajao_ayresi,Cacajao_melanocephalus,Cacajao_calvus,Chiropotes_sagulatus,Chiropotes_israelita,Chiropotes_albinasus,Pithecia_albicans,Pithecia_vanzolinii,Pithecia_pissinattii,Pithecia_mittermeieri,Pithecia_hirsuta,Pithecia_pithecia,Pithecia_chrysocephala,Plecturocebus_grovesi,Plecturocebus_moloch,Plecturocebus_bernhardi,Plecturocebus_dubius,Plecturocebus_caligatus,Plecturocebus_cupreus,Plecturocebus_brunneus,Plecturocebus_miltoni,Plecturocebus_cinerascens,Plecturocebus_hoffmannsi,Cheracebus_torquatus,Cheracebus_regulus,Cheracebus_lucifer,Cheracebus_lugens,Cephalopachus_bancanus,Carlito_syrichta,Tarsius_lariang,Tarsius_wallacei,Eulemur_rufus,Eulemur_collaris,Eulemur_fulvus,Eulemur_albifrons,Eulemur_sanfordi,Eulemur_flavifrons,Eulemur_macaco,Eulemur_coronatus,Eulemur_mongoz,Eulemur_rubriventer,Hapalemur_griseus,Hapalemur_meridionalis,Hapalemur_gilberti,Hapalemur_alaotrensis,Hapalemur_occidentalis,Prolemur_simus,Lemur_catta,Varecia_rubra,Varecia_variegata,Propithecus_coquerelli,Propithecus_verreauxi,Propithecus_tattersalli,Propithecus_coronatus,Propithecus_diadema,Propithecus_perrieri,Propithecus_edwardsi,Avahi_laniger,Avahi_peyrierasi,Indri_indri,Microcebus_murinus,Mirza_zaza,Cheirogaleus_major,Cheirogaleus_medius,Lepilemur_septentrionalis,Lepilemur_ankaranensis,Lepilemur_dorsalis,Lepilemur_ruficaudatus,Daubentonia_madagascariensis,Nycticebus_coucang,Nycticebus_bengalensis,Nycticebus_pygmaeus,Loris_tardigradus,Loris_lydekkerianus,Perodicticus_ibeanus,Perodicticus_potto,Arctocebus_calabarensis,Otolemur_garnettii,Otolemur_crassicaudatus,Galago_senegalensis,Galago_moholi,Galagoides_demidoff" ../hg38.447way.hal PrimatesAnc000.100kb.maf
#The values produced from this command line up nicely with existing values from the all mammals alignment!
../phast/bin/phyloFit  PrimatesAnc000.100kb.maf -i MAF --subst-mod REV --EM --tree ../hg38.447way.scientificNames.nh.txt --out-root PrimatesAnc000.100kb

../cactus-bin-v2.6.13/bin/halLiftover ../hg38.447way.hal PrimatesAnc000 PrimatesAnc000_Merged_rmsk.fasta.filt.bed Homo_sapiens PrimatesAnc000_Merged_rmsk.fasta.filt.Homo_sapiens.bed --noDupes --outPSL

#Now we will do it for chrX and chrY
awk -v OFS='\t' '{if ($14=="chrX") print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.Homo_sapiens.bed | bedops --chop 1 - | shuf -n 100000 | sort -k1,1 -k2,2n | bedtools merge -i - > PrimatesAnc000_Merged_rmsk.fasta.filt.chrX.100kb.bed
awk -v OFS='\t' '{if ($14=="chrY") print $10,$12,$13,$14,$16,$17}' PrimatesAnc000_Merged_rmsk.fasta.filt.Homo_sapiens.bed | bedops --chop 1 - | shuf -n 100000 | sort -k1,1 -k2,2n | bedtools merge -i - > PrimatesAnc000_Merged_rmsk.fasta.filt.chrY.100kb.bed

../cactus-bin-v2.6.13/bin/hal2maf --refTargets PrimatesAnc000_Merged_rmsk.fasta.filt.chrX.100kb.bed --refGenome PrimatesAnc000 --onlyOrthologs --targetGenomes "Papio_anubis,Papio_papio,Papio_hamadryas,Papio_ursinus,Papio_kindae,Papio_cynocephalus,Lophocebus_aterrimus,Theropithecus_gelada,Cercocebus_atys,Cercocebus_lunulatus,Cercocebus_torquatus,Cercocebus_chrysogaster,Mandrillus_leucophaeus,Mandrillus_sphinx,Macaca_leonina,Macaca_silenus,Macaca_siberu,Macaca_nemestrina,Macaca_nigra,Macaca_maura,Macaca_tonkeana,Macaca_fuscata,Macaca_cyclopis,Macaca_mulatta,Macaca_fascicularis,Macaca_assamensis,Macaca_thibetana,Macaca_radiata,Macaca_arctoides,Cercopithecus_albogularis,Cercopithecus_nictitans,Cercopithecus_ascanius,Cercopithecus_cephus,Cercopithecus_petaurista,Cercopithecus_lowei,Cercopithecus_mona,Cercopithecus_pogonias,Cercopithecus_neglectus,Cercopithecus_diana,Cercopithecus_roloway,Cercopithecus_hamlyni,Miopithecus_ogouensis,Allochrocebus_preussi,Allochrocebus_lhoesti,Allochrocebus_solatus,Chlorocebus_aethiops,Chlorocebus_pygerythrus,Chlorocebus_sabaeus,Erythrocebus_patas,Allenopithecus_nigroviridis,Trachypithecus_phayrei,Trachypithecus_crepusculus,Trachypithecus_obscurus,Trachypithecus_melamera,Trachypithecus_auratus,Trachypithecus_cristatus,Trachypithecus_germaini,Trachypithecus_francoisi,Trachypithecus_leucocephalus,Trachypithecus_laotum,Trachypithecus_hatinhensis,Trachypithecus_geei,Trachypithecus_pileatus,Semnopithecus_entellus,Semnopithecus_hypoleucos,Semnopithecus_priam,Semnopithecus_schistaceus,Semnopithecus_johnii,Semnopithecus_vetulus,Pygathrix_cinerea,Pygathrix_nigripes_b,Pygathrix_nigripes_a,Rhinopithecus_strykeri,Rhinopithecus_bieti,Rhinopithecus_roxellana,Nasalis_larvatus,Presbytis_mitrata,Presbytis_comata,Colobus_polykomos,Colobus_guereza,Colobus_angolensis,Piliocolobus_tephrosceles,Piliocolobus_gordonorum,Piliocolobus_kirkii,Piliocolobus_badius,Pan_paniscus,Pan_troglodytes,Homo_sapiens,Gorilla_gorilla,Gorilla_beringei,Pongo_abelii,Pongo_pygmaeus,Hylobates_pileatus_b,Hylobates_pileatus_a,Hylobates_abbotti,Hylobates_muelleri,Hylobates_agilis,Hylobates_klossii,Hoolock_leuconedys,Nomascus_siki_b,Nomascus_siki_a,Nomascus_gabriellae,Nomascus_annamensis,Nomascus_concolor,Symphalangus_syndactylus,Mico_schneideri,Mico_argentatus,Mico_humeralifer,Callibella_humilis,Cebuella_pygmaea,Cebuella_niveiventris,Callithrix_kuhlii,Callithrix_jacchus,Callithrix_geoffroyi,Callimico_goeldii,Leontopithecus_rosalia,Leontopithecus_chrysomelas,Saguinus_bicolor,Saguinus_midas,Saguinus_oedipus,Saguinus_geoffroyi,Saguinus_mystax,Saguinus_labiatus,Saguinus_inustus,Saguinus_imperator,Leontocebus_illigeri,Leontocebus_fuscicollis,Leontocebus_nigricollis,Aotus_vociferans,Aotus_griseimembra,Aotus_nancymaae,Aotus_azarae,Aotus_trivirgatus,Cebus_olivaceus,Cebus_albifrons,Cebus_unicolor,Sapajus_macrocephalus,Sapajus_apella,Saimiri_oerstedii,Saimiri_ustus,Saimiri_cassiquiarensis,Saimiri_macrodon,Saimiri_sciureus,Saimiri_boliviensis,Alouatta_seniculus,Alouatta_juara,Alouatta_puruensis,Alouatta_macconnelli,Alouatta_nigerrima,Alouatta_caraya,Alouatta_belzebul,Alouatta_discolor,Alouatta_palliata,Ateles_marginatus,Ateles_chamek,Ateles_belzebuth,Ateles_paniscus,Ateles_geoffroyi_b,Ateles_geoffroyi_a,Lagothrix_lagothricha,Cacajao_hosomi,Cacajao_ayresi,Cacajao_melanocephalus,Cacajao_calvus,Chiropotes_sagulatus,Chiropotes_israelita,Chiropotes_albinasus,Pithecia_albicans,Pithecia_vanzolinii,Pithecia_pissinattii,Pithecia_mittermeieri,Pithecia_hirsuta,Pithecia_pithecia,Pithecia_chrysocephala,Plecturocebus_grovesi,Plecturocebus_moloch,Plecturocebus_bernhardi,Plecturocebus_dubius,Plecturocebus_caligatus,Plecturocebus_cupreus,Plecturocebus_brunneus,Plecturocebus_miltoni,Plecturocebus_cinerascens,Plecturocebus_hoffmannsi,Cheracebus_torquatus,Cheracebus_regulus,Cheracebus_lucifer,Cheracebus_lugens,Cephalopachus_bancanus,Carlito_syrichta,Tarsius_lariang,Tarsius_wallacei,Eulemur_rufus,Eulemur_collaris,Eulemur_fulvus,Eulemur_albifrons,Eulemur_sanfordi,Eulemur_flavifrons,Eulemur_macaco,Eulemur_coronatus,Eulemur_mongoz,Eulemur_rubriventer,Hapalemur_griseus,Hapalemur_meridionalis,Hapalemur_gilberti,Hapalemur_alaotrensis,Hapalemur_occidentalis,Prolemur_simus,Lemur_catta,Varecia_rubra,Varecia_variegata,Propithecus_coquerelli,Propithecus_verreauxi,Propithecus_tattersalli,Propithecus_coronatus,Propithecus_diadema,Propithecus_perrieri,Propithecus_edwardsi,Avahi_laniger,Avahi_peyrierasi,Indri_indri,Microcebus_murinus,Mirza_zaza,Cheirogaleus_major,Cheirogaleus_medius,Lepilemur_septentrionalis,Lepilemur_ankaranensis,Lepilemur_dorsalis,Lepilemur_ruficaudatus,Daubentonia_madagascariensis,Nycticebus_coucang,Nycticebus_bengalensis,Nycticebus_pygmaeus,Loris_tardigradus,Loris_lydekkerianus,Perodicticus_ibeanus,Perodicticus_potto,Arctocebus_calabarensis,Otolemur_garnettii,Otolemur_crassicaudatus,Galago_senegalensis,Galago_moholi,Galagoides_demidoff" ../hg38.447way.hal PrimatesAnc000.100kb.chrX.maf
../cactus-bin-v2.6.13/bin/hal2maf --refTargets PrimatesAnc000_Merged_rmsk.fasta.filt.chrY.100kb.bed --refGenome PrimatesAnc000 --onlyOrthologs --targetGenomes "Papio_anubis,Papio_papio,Papio_hamadryas,Papio_ursinus,Papio_kindae,Papio_cynocephalus,Lophocebus_aterrimus,Theropithecus_gelada,Cercocebus_atys,Cercocebus_lunulatus,Cercocebus_torquatus,Cercocebus_chrysogaster,Mandrillus_leucophaeus,Mandrillus_sphinx,Macaca_leonina,Macaca_silenus,Macaca_siberu,Macaca_nemestrina,Macaca_nigra,Macaca_maura,Macaca_tonkeana,Macaca_fuscata,Macaca_cyclopis,Macaca_mulatta,Macaca_fascicularis,Macaca_assamensis,Macaca_thibetana,Macaca_radiata,Macaca_arctoides,Cercopithecus_albogularis,Cercopithecus_nictitans,Cercopithecus_ascanius,Cercopithecus_cephus,Cercopithecus_petaurista,Cercopithecus_lowei,Cercopithecus_mona,Cercopithecus_pogonias,Cercopithecus_neglectus,Cercopithecus_diana,Cercopithecus_roloway,Cercopithecus_hamlyni,Miopithecus_ogouensis,Allochrocebus_preussi,Allochrocebus_lhoesti,Allochrocebus_solatus,Chlorocebus_aethiops,Chlorocebus_pygerythrus,Chlorocebus_sabaeus,Erythrocebus_patas,Allenopithecus_nigroviridis,Trachypithecus_phayrei,Trachypithecus_crepusculus,Trachypithecus_obscurus,Trachypithecus_melamera,Trachypithecus_auratus,Trachypithecus_cristatus,Trachypithecus_germaini,Trachypithecus_francoisi,Trachypithecus_leucocephalus,Trachypithecus_laotum,Trachypithecus_hatinhensis,Trachypithecus_geei,Trachypithecus_pileatus,Semnopithecus_entellus,Semnopithecus_hypoleucos,Semnopithecus_priam,Semnopithecus_schistaceus,Semnopithecus_johnii,Semnopithecus_vetulus,Pygathrix_cinerea,Pygathrix_nigripes_b,Pygathrix_nigripes_a,Rhinopithecus_strykeri,Rhinopithecus_bieti,Rhinopithecus_roxellana,Nasalis_larvatus,Presbytis_mitrata,Presbytis_comata,Colobus_polykomos,Colobus_guereza,Colobus_angolensis,Piliocolobus_tephrosceles,Piliocolobus_gordonorum,Piliocolobus_kirkii,Piliocolobus_badius,Pan_paniscus,Pan_troglodytes,Homo_sapiens,Gorilla_gorilla,Gorilla_beringei,Pongo_abelii,Pongo_pygmaeus,Hylobates_pileatus_b,Hylobates_pileatus_a,Hylobates_abbotti,Hylobates_muelleri,Hylobates_agilis,Hylobates_klossii,Hoolock_leuconedys,Nomascus_siki_b,Nomascus_siki_a,Nomascus_gabriellae,Nomascus_annamensis,Nomascus_concolor,Symphalangus_syndactylus,Mico_schneideri,Mico_argentatus,Mico_humeralifer,Callibella_humilis,Cebuella_pygmaea,Cebuella_niveiventris,Callithrix_kuhlii,Callithrix_jacchus,Callithrix_geoffroyi,Callimico_goeldii,Leontopithecus_rosalia,Leontopithecus_chrysomelas,Saguinus_bicolor,Saguinus_midas,Saguinus_oedipus,Saguinus_geoffroyi,Saguinus_mystax,Saguinus_labiatus,Saguinus_inustus,Saguinus_imperator,Leontocebus_illigeri,Leontocebus_fuscicollis,Leontocebus_nigricollis,Aotus_vociferans,Aotus_griseimembra,Aotus_nancymaae,Aotus_azarae,Aotus_trivirgatus,Cebus_olivaceus,Cebus_albifrons,Cebus_unicolor,Sapajus_macrocephalus,Sapajus_apella,Saimiri_oerstedii,Saimiri_ustus,Saimiri_cassiquiarensis,Saimiri_macrodon,Saimiri_sciureus,Saimiri_boliviensis,Alouatta_seniculus,Alouatta_juara,Alouatta_puruensis,Alouatta_macconnelli,Alouatta_nigerrima,Alouatta_caraya,Alouatta_belzebul,Alouatta_discolor,Alouatta_palliata,Ateles_marginatus,Ateles_chamek,Ateles_belzebuth,Ateles_paniscus,Ateles_geoffroyi_b,Ateles_geoffroyi_a,Lagothrix_lagothricha,Cacajao_hosomi,Cacajao_ayresi,Cacajao_melanocephalus,Cacajao_calvus,Chiropotes_sagulatus,Chiropotes_israelita,Chiropotes_albinasus,Pithecia_albicans,Pithecia_vanzolinii,Pithecia_pissinattii,Pithecia_mittermeieri,Pithecia_hirsuta,Pithecia_pithecia,Pithecia_chrysocephala,Plecturocebus_grovesi,Plecturocebus_moloch,Plecturocebus_bernhardi,Plecturocebus_dubius,Plecturocebus_caligatus,Plecturocebus_cupreus,Plecturocebus_brunneus,Plecturocebus_miltoni,Plecturocebus_cinerascens,Plecturocebus_hoffmannsi,Cheracebus_torquatus,Cheracebus_regulus,Cheracebus_lucifer,Cheracebus_lugens,Cephalopachus_bancanus,Carlito_syrichta,Tarsius_lariang,Tarsius_wallacei,Eulemur_rufus,Eulemur_collaris,Eulemur_fulvus,Eulemur_albifrons,Eulemur_sanfordi,Eulemur_flavifrons,Eulemur_macaco,Eulemur_coronatus,Eulemur_mongoz,Eulemur_rubriventer,Hapalemur_griseus,Hapalemur_meridionalis,Hapalemur_gilberti,Hapalemur_alaotrensis,Hapalemur_occidentalis,Prolemur_simus,Lemur_catta,Varecia_rubra,Varecia_variegata,Propithecus_coquerelli,Propithecus_verreauxi,Propithecus_tattersalli,Propithecus_coronatus,Propithecus_diadema,Propithecus_perrieri,Propithecus_edwardsi,Avahi_laniger,Avahi_peyrierasi,Indri_indri,Microcebus_murinus,Mirza_zaza,Cheirogaleus_major,Cheirogaleus_medius,Lepilemur_septentrionalis,Lepilemur_ankaranensis,Lepilemur_dorsalis,Lepilemur_ruficaudatus,Daubentonia_madagascariensis,Nycticebus_coucang,Nycticebus_bengalensis,Nycticebus_pygmaeus,Loris_tardigradus,Loris_lydekkerianus,Perodicticus_ibeanus,Perodicticus_potto,Arctocebus_calabarensis,Otolemur_garnettii,Otolemur_crassicaudatus,Galago_senegalensis,Galago_moholi,Galagoides_demidoff" ../hg38.447way.hal PrimatesAnc000.100kb.chrY.maf

../phast/bin/phyloFit PrimatesAnc000.100kb.chrX.maf -i MAF --subst-mod REV --EM --tree ../hg38.447way.scientificNames.nh.txt --out-root PrimatesAnc000.100kb.chrX
../phast/bin/phyloFit PrimatesAnc000.100kb.chrY.maf -i MAF --subst-mod REV --EM --tree ../hg38.447way.scientificNames.nh.txt --out-root PrimatesAnc000.100kb.chrY
