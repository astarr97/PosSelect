Files and usage:
Find_parameters.ipynb was used to obtain the parameters for mapping PhyloP scores to absolute selection coefficients.  This uses G250.MskHum.PhyloP.bins.txt, the PhyloP score distribution.
Process_Sims.ipynb was used to plot the results of the simulations.
tennesen_noncoding_elems.slim is the script actually used to do the simulations.
make_do_sims.py was used to make shell scripts to submit using driver.sh
make_do_sims.py contains the input parameters used for tennesen_noncoding_elems.slim
collate_nc_sim_results.py and the commands in collate_results.sh were used to process the simulation output and combine across simulations.
Finally, the three .zip files starting with 661 contain the results for various values of the pb parameter.


Details of the simulations:
To perform population genetics simulations, we used SLiM v4.3.  For all simulations, we use a well-established model of human demographic history (Tennesen et al. 2013) and based our code on that used in Murga-Moreno et al. 2024, updating the code to make it compatible with SLiM v4.  

The primary difficulty in performing simulations lies in mapping PhyloP scores (or effects on chromatin accessibility) to absolute selection coefficients.  Although the relationship between PhyloP scores and absolute selection coefficients is unknown, it is very likely that sites with higher PhyloP scores or larger effects on CA have higher absolute selection coefficients.  We focused on PhyloP scores for our simulations as we computed those genome-wide and attempted to assign absolute selection coefficients to them in a reasonable manner (based on previous work) that is compatible with SLiM, although this is inherently inexact and somewhat arbitrary.  To do this, we restricted only to sites with at least 251 species in the alignment and counted the number of sites with a PhyloP score in each of 300 bins (with bin width approximately 0.1).  We then split sites into 8 bins numbered 1-8: those with PhyloP scores less than 1, from 1-2, 2-3, 3-4, 4-5, 5-6, 6-7.5, and 7.5-11.  The last two bins were chosen based on the somewhat discrete distribution of PhyloP scores, as highly conserved sites generally have scores close to 7.4, 8.5, and 10.5.  We then calculated the number of sites in each of these bins which resulted in approximately 80% of sites were assigned to bin 1, 11% to bin 2, 4% to bin 3, 1% to bin 4, 0.5% to bin 5, 0.5% to bin 6, 0.8% to bin 7, and 0.7% to bin 8.

To map those bins onto absolute selection coefficients (|s|, we considered anything in bin 1 to be neutral (i.e. |s| = 0).  In previous work, weakly selected sites were assigned absolute selection coefficients from an exponential distribution with parameter |s| = 10/(2*Ne) and strongly selected sites were assigned with parameter |s| = 500/(2*Ne) so we used those values as a guide when assigning absolute selection coefficients to the remaining bins.  We used the following absolute selection coefficients as the parameter for an exponential distribution for bins, in order from 2 to 5 in order: 5/(200*Ne), 5/(20*Ne), 5/(200*Ne), 20/(2*Ne). For the more conserved sites in bins 6 to 8, we drew absolute selection coefficients from a normal distribution with mean 50/(2*Ne), 125/(2*Ne), and 500/(2*Ne) and standard deviation equal to the mean divided by 10, which ensures that the values drawn from these distributions are extremely unlikely to be negative.

Although it is not possible to perfectly capture the complexity of the genome, we attempted to capture the interspersed nature of cis-regulatory elements by constructing a 200 kb region consisting of two types of genomic elements.  A “mostly neutral” type that covered the first and last 63 kb as well as the 10 kb between each of the “mostly conserved” type that were 500 bp in length and evenly distributed in the central 64 kb.  We controlled the proportion of positive selection using the parameter pb such that either 0%, approximately 0.1%, or 1% of non-neutral sites had positive selection coefficients.  For the exact details of how these genomic elements were constructed in SLiM, please refer to: https://github.com/astarr97/PosSelect/tree/main/Simulations.  

We performed 1,000 simulations of individual 200 kb elements and then combined information across all simulations, recording the selection coefficients for each polymorphism and fixed substitution that resulted from the simulation.  We then reassigned those selection coefficients back to PhyloP scores based on the properties of the distributions from which the selection coefficients were drawn.  For example, absolute selection coefficients greater than 0.017 (which corresponds to 5 standard deviations on either side of the mean of the bin 8 normal distribution) were assigned to bin 8.  For exact details of the reassignment, please refer to: https://github.com/astarr97/PosSelect/tree/main/Simulations. After assigning absolute selection coefficients back to PhyloP scores, we then compared the PhyloP score distributions for fixed and polymorphic sites and computed αCons as described below.